<!DOCTYPE html>
<html>
    <head>
        <title>Halving Game</title>
        <style>
            body {
                font-family: sans-serif;
                text-align: center;
            }
            #n {
                font-size: 44pt;
                margin: 20pt;
            }
            button {
                font-size: 16pt;
                margin: 10pt;
            }
        </style>
    </head>
    <body>
        <h1>Halving Game</h1>
        <div id="n"></div>
        <div id="message">Game start</div>
        <button id="button1" onclick="playerMove(1)">Subtract 1</button>
        <button id="button2" onclick="playerMove(2)">Divide by 2</button>
        <script>
            let n = 15;
            update();
            function update(option, player) {
                if (option !== undefined) {
                    let prevNum = n;
                    n = (option === 1) ? action1(n) : action2(n);
                    let message = player + ": " + prevNum + " -> " + n;
                    if (n === 0) {
                        message += " -- " + player + " won!";
                        document.getElementById("button1").disabled = true;
                        document.getElementById("button2").disabled = true;
                    }
                    document.getElementById("message").textContent = message;
                }
                document.getElementById("n").textContent = n;
            }

            function action1(x) { return x - 1; }
            function action2(x) { return Math.floor(x / 2); }

            function playerMove(option) {
                update(option, "Player");
                setTimeout(aiMove, 500);
            }

            function aiMove() {
                let outcome1 = minimax(action1(n));
                let outcome2 = minimax(action2(n));
                let aiOption = (outcome1 > outcome2) ? 1 : 2;
                update(aiOption, "AI");
            }

            function minimax(x) {
                if (x === 0) return +1;
                let outcome1 = minimax(action1(x));
                let outcome2 = minimax(action2(x));
                return Math.max(-outcome1, -outcome2);
            }

        </script>
    </body>
</html>